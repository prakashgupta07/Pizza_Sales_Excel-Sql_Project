CREATE DATABASE PIZZA;
USE PIZZA;
SELECT * FROM PIZZA_SALES;
-- CHANGING COLUMN ORDER_DATE DATATYPE TEXT TO DATE
UPDATE PIZZA_SALES SET ORDER_DATE =STR_TO_DATE(ORDER_DATE,"%d-%m-%Y");
-- CHANGING COUMN ORDER_TIME DATATYPE  TEXT TO TIME 
UPDATE PIZZA_SALES SET ORDER_TIME =str_to_date(ORDER_TIME,"%T");
DESCRIBE PIZZA_SALES;
--A. KPI's
-- 1. Total Revenue: The sum of the total price of all pizza orders.
SELECT ROUND(SUM(TOTAL_PRICE),2) AS TOTAL_REVENUE FROM PIZZA_SALES;

-- 2. Average Order Value: The average amount spent per order,calculate by 
-- dividing the total revenue by the total number of orders.
SELECT SUM(TOTAL_PRICE)/ COUNT(DISTINCT ORDER_ID) AS AVERAGE_ORDER_VALUE FROM PIZZA_SALES;

-- 3. Total Pizza Sold: The sum of the quantities of all pizza sold.
SELECT SUM(QUANTITY) AS TOTAL_PIZZA_SOLD 
FROM PIZZA_SALES;

-- 4. Total Orders: The total of order placed.
SELECT COUNT(DISTINCT ORDER_ID) AS TOTAL_ORDER 
FROM PIZZA_SALES; 

-- 5. Average Pizza Per Order: The average number of pizza sold per order,calculate by  dividing the 
--   total number of pizza sold by the total number of orders.
SELECT ROUND(SUM(QUANTITY)/COUNT(DISTINCT ORDER_ID),2) AS AVERAGE_PIZZA_PER_ORDER 
FROM PIZZA_SALES;

 
-- B. Daily Trend for Total Orders.
SELECT DAYNAME(ORDER_DATE) AS ORDER_DAY,COUNT(DISTINCT ORDER_ID) AS TOTAL_ORDER 
FROM PIZZA_SALES 
GROUP BY 1 
ORDER BY 2 DESC;

-- C. Hourly Trend for Total Order.
SELECT HOUR(ORDER_TIME) AS HOURS_ORDER , COUNT(DISTINCT ORDER_ID) AS TOTAL_ORDER 
FROM PIZZA_SALES 
GROUP BY 1 
ORDER BY 2 DESC;

-- D. Percentage of Sales by Pizza Category.

SELECT  PIZZA_CATEGORY,ROUND(SUM(TOTAL_PRICE),2),
ROUND(SUM(TOTAL_PRICE)  / (SELECT SUM(TOTAL_PRICE)  FROM PIZZA_SALES)* 100,2) AS PCT 
FROM PIZZA_SALES 
GROUP BY 1 ;

-- E. Percentage of sales by Pizza Size:
SELECT PIZZA_SIZE,ROUND(SUM(TOTAL_PRICE),2),
ROUND(SUM(TOTAL_PRICE)  / (SELECT SUM(TOTAL_PRICE)  FROM PIZZA_SALES)* 100,2) AS PCT 
FROM PIZZA_SALES 
GROUP BY 1 ;

-- F. Total Pizzas Sold by Pizza category:
SELECT PIZZA_CATEGORY,SUM(QUANTITY)  AS TOTAL_PIZZA_SOLD 
FROM PIZZA_SALES 
GROUP BY 1;

-- G.Top 5 Best Sellers by Total Pizza Sold:
SELECT PIZZA_NAME,SUM(QUANTITY) AS TOTAL_PIZZA_SOLD 
FROM  PIZZA_SALES 
GROUP BY 1 
ORDER BY 2 DESC LIMIT 5;

-- H.Bottom 5 Worst Sellers by total Pizzas sold:
SELECT PIZZA_NAME,SUM(QUANTITY) AS TOTAL_PIZZA_SOLD 
FROM  PIZZA_SALES 
GROUP BY 1 
ORDER BY 2 ASC LIMIT 5;




